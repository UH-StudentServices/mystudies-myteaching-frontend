<!--
  ~ This file is part of MystudiesMyteaching application.
  ~
  ~ MystudiesMyteaching application is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ MystudiesMyteaching application is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with MystudiesMyteaching application.  If not, see <http://www.gnu.org/licenses/>.
-->

<div class="useful-links" id="useful-links">
  <div class="edit-link-wrapper">
    <h3 translate="usefulLinks.title"></h3>
    <edit-link on-edit="edit()" on-exit-edit="exitEdit()"></edit-link>
  </div>

  <ul role="list"
      class="list-of-links"
      dnd-list="usefulLinks"
      dnd-allowed-types="['usefulLink']">
    <li ng-repeat="link in usefulLinks"
        role="listitem"
        dnd-draggable="link"
        dnd-type="'usefulLink'"
        dnd-moved="updateOrder($index)"
        dnd-effect-allowed="move">
      <a ng-hide="editMode" href="{{link.url}}" target="_blank" class="list-of-links__link button--action icon--arrow-right">
        {{ link.description | renderUsefulLinkDescription:link.type }}
      </a>
      <editable-useful-link ng-show="editMode"
                            useful-link="link"
                            editable="link.type === UsefulLinkType.USER_DEFINED">
      </editable-useful-link>
      <span ng-show="editMode && !link.edit" class="useful-links__delete-link" ng-click="deleteLink(link)" role="button">
        <i class="hy hy-remove"></i>
      </span>
    </li>
  </ul>

  <div ng-show="editMode && !editLink" class="new-useful-link-container">
    <div class="new-useful-link">
      <form name="newLinkUrlForm">
        <input ng-model="newLink.url"
               type="text"
               ng-change="searchPageTitle(newLink.url)"
               placeholder="{{::('usefulLinks.addNewLink' | translate | capitalize)}}"
               ui-keypress="{'enter':'addNewUsefulLink()'}">
      </form>
      <span ng-show="pageTitleSearchState === SearchState.SEARCHING">
        <i class="hy hy-spinner hy-spin"></i>
      </span>
      <a ng-show="newLink.url" tabindex="0" ng-click="clearSearch()">
        <i class="hy hy-close"></i>
      </a>
      <a class="new-useful-link__add-button" tabindex="0" ng-click="addNewUsefulLink()">
        <i class="hy hy-plus"></i>
      </a>
    </div>
    <useful-link-title ng-show="pageTitleSearchState === SearchState.SHOW_RESULTS"
                       model="newLink.description"
                       enter-fn="addNewUsefulLink">
    </useful-link-title>
  </div>

  <ul class="list-of-links">
    <li limit-visibility="['MY_STUDIES_ONLY']">
      <a class="list-of-links__link useful-links__fixed-link-button" href="{{getStudentServicesLink()}}" target="_blank">
        <span class="useful-links__fixed-link-title" translate="usefulLinks.studentServices"></span>
      </a>
    </li>

    <li>
      <a class="list-of-links__link useful-links__fixed-link-button" href="{{getHelpdeskLink()}}" target="_blank">
        <p class="useful-links__fixed-link-title">Helpdesk</p>
        <p class="useful-links__fixed-link-info">helpdesk@helsinki.fi</p>
      </a>
    </li>
  </ul>

</div>
